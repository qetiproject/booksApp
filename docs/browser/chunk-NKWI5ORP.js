import{H as h,I as l,q as m}from"./chunk-ALFWPUQN.js";import{ia as a,n as r,na as n}from"./chunk-VG73PTL2.js";var B=(()=>{let t=class t{constructor(){this.STORAGE_KEY=m.CATALOGUE_STORAGE_KEY,this.messages=n(h),this.errorMessage="Failed to save catalogue to localStorage",this.books=new r([]),this.books$=this.books.asObservable(),this.loadBooks()}addBook(o){let e=this.mapToBookView(o),i=this.books.value;i.some(c=>c.id==e.id)||this.updateBooks([e,...i])}mapToBookView(o){return{id:o.id,title:o.volumeInfo.title,authors:o.volumeInfo.authors??[],language:o.volumeInfo.language,imageLinks:{thumbnail:o.volumeInfo.imageLinks.thumbnail||"assets/no-image.png",smallThumbnail:o.volumeInfo.imageLinks.smallThumbnail||"assets/no-image.png"},categories:o.volumeInfo.categories}}removeBook(o){this.updateBooks(this.books.value.filter(e=>e.id!==o.id))}loadBooks(){let o=localStorage.getItem(this.STORAGE_KEY);this.books.next(o?JSON.parse(o):[])}updateBooks(o){this.books.next(o);try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(o))}catch(e){this.messages.showMessage({text:`\u{1F4DA} ${this.errorMessage}- ${e}`,severity:l.Error,duration:5e3})}}};t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"});let s=t;return s})();export{B as a};
