import{$ as mt,A as Te,Aa as We,Ab as ee,Ac as Gt,Ba as De,Bb as q,Bc as zt,C as nt,Ca as u,Cb as Ue,D as at,Da as $,Db as Q,E as st,Ea as M,Eb as we,F as E,Fa as pt,Fb as ye,Ha as ft,I as c,Ia as vt,Ic as de,Ja as gt,K as S,Ka as Le,L as T,La as Ve,M as A,Ma as Xe,N as Ie,Na as ht,Oa as bt,Ob as K,Pa as Ze,Pb as W,Q as N,Qb as Dt,Ra as ie,S as Ee,Sa as le,Sb as Ce,T as m,Ta as J,Tb as Lt,U as fe,Ua as F,Va as Pe,Wa as xt,Xa as kt,Y as h,Ya as wt,Yb as G,Z as Be,Za as yt,Zb as R,_ as lt,_a as U,_b as z,a as X,aa as ct,ab as Ct,ac as Vt,b as oe,ba as dt,bb as _t,bc as Pt,c as s,ca as ut,cc as jt,d as v,da as D,dc as At,e as y,ea as L,ec as Nt,f as ot,fa as ve,ga as V,gc as Ot,h as _e,ha as P,hb as St,ia as b,ja as d,jb as H,k as He,ka as p,kb as je,la as I,lb as Tt,m as Se,ma as g,n as it,na as w,nb as Ae,oa as Fe,ob as It,oc as $t,p as Z,pa as Me,pb as Et,qa as Re,qb as et,r as se,ra as Je,rb as me,rc as re,s as rt,sa as B,sb as Bt,ta as ge,tb as Ne,ua as x,ub as Ft,v as O,va as he,vb as Oe,wa as k,wb as $e,xa as be,xb as Mt,y as Ye,ya as xe,yb as Rt,yc as Ut,za as ke,zb as ce,zc as Kt}from"./chunk-7WGUVRVG.js";var qt=(()=>{let e=class e{constructor(){this.addToFavourites=J(),this.addToCatalogue=J()}addToCatalogueEvent(){this.addToCatalogue.emit()}addToFavouritesEvent(){this.addToFavourites.emit()}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-book-actions"]],outputs:{addToFavourites:"addToFavourites",addToCatalogue:"addToCatalogue"},decls:9,vars:0,consts:[[1,"mt-6","mb-6","flex","flex-wrap","gap-3"],[1,"inline-flex","items-center","gap-2","px-6","py-2.5","rounded-lg","bg-pink-50","text-pink-700","text-sm","font-medium","border","border-pink-200","hover:bg-pink-100","transition","shadow-sm",3,"click"],[1,"material-icons","text-pink-600"],[1,"inline-flex","items-center","gap-2","px-6","py-2.5","rounded-lg","bg-slate-50","text-slate-800","text-sm","font-medium","border","border-slate-200","hover:bg-slate-100","transition","shadow-sm",3,"click"],[1,"material-icons","text-slate-600"]],template:function(o,r){o&1&&(g(0,"div",0)(1,"button",1),he("click",function(){return r.addToFavouritesEvent()}),g(2,"span",2),u(3,"favorite"),w(),u(4," Add to Favourites "),w(),g(5,"button",3),he("click",function(){return r.addToCatalogueEvent()}),g(6,"span",4),u(7,"library_add"),w(),u(8," Add to Catalogue "),w()())},encapsulation:2});let t=e;return t})();var yo=t=>["/books",t];function Co(t,e){if(t&1&&(d(0,"button",8),u(1," Details "),p()),t&2){let n=k();b("routerLink",Ve(1,yo,n.book().id))}}function _o(t,e){if(t&1){let n=B();d(0,"button",11),x("click",function(){S(n);let o=k();return T(o.onAddInFavourite())}),A(),d(1,"svg",12),I(2,"path",13),p()()}}function So(t,e){if(t&1){let n=B();d(0,"button",14),x("click",function(){S(n);let o=k();return T(o.onDelete())}),A(),d(1,"svg",12),I(2,"path",15),p()()}}var Qt=(()=>{let e=class e{constructor(){this.book=F.required(),this.showDelete=F(!1),this.showFavourite=F(!1),this.showDetailsBtn=F(!1),this.bookDelete=new fe,this.addInFavourite=new fe,this.router=c(H),this.messages=c(z)}onDelete(){this.bookDelete.emit(this.book())}onAddInFavourite(){this.addInFavourite.emit(this.book()),this.router.navigateByUrl("/favourites"),this.messages.showMessage({text:`\u{1F4DA} "${this.book().title}" \u10EC\u10D0\u10E0\u10DB\u10D0\u10E2\u10D4\u10D1\u10D8\u10D7 \u10D3\u10D0\u10D4\u10DB\u10D0\u10E2\u10D0 \u10D7\u10E5\u10D5\u10D4\u10DC\u10E1 \u10E4\u10D0\u10D5\u10DD\u10E0\u10D8\u10E2\u10D4\u10D1\u10E8\u10D8!`,severity:G.Success})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-book-card"]],inputs:{book:[1,"book"],showDelete:[1,"showDelete"],showFavourite:[1,"showFavourite"],showDetailsBtn:[1,"showDetailsBtn"]},outputs:{bookDelete:"bookDelete",addInFavourite:"addInFavourite"},decls:16,vars:8,consts:[[1,"w-full","max-w-sm","bg-white","rounded-3xl","shadow-lg","border","border-slate-200","flex","flex-col","overflow-hidden","transition-transform","transform","hover:scale-105","hover:shadow-2xl"],[1,"w-full","h-48","bg-gray-100","overflow-hidden","relative"],["loading","lazy",1,"w-full","h-full","object-contain","transition-transform","duration-300","ease-out","hover:scale-105",3,"src","alt"],[1,"px-5","py-4","flex-1","flex","flex-col","justify-between","space-y-2"],[1,"text-xl","font-bold","text-slate-900","truncate"],[1,"mt-2","text-sm","text-slate-700"],[1,"mt-4","flex","items-center","justify-between"],[1,"flex","gap-2"],[1,"px-4","py-2","text-sm","font-medium","rounded-lg","bg-blue-600","text-white","hover:bg-blue-700",3,"routerLink"],["aria-label","Add to favourite",1,"p-2","rounded-full","bg-red-100","text-red-600","hover:bg-red-200"],["aria-label","Delete",1,"p-2","rounded-full","bg-red-600","text-white","hover:bg-red-700"],["aria-label","Add to favourite",1,"p-2","rounded-full","bg-red-100","text-red-600","hover:bg-red-200",3,"click"],["viewBox","0 0 24 24",1,"w-5","h-5","fill-current"],["d",`M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 
                       2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09
                       C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5
                       c0 3.78-3.4 6.86-8.55 11.54L12 21.35z`],["aria-label","Delete",1,"p-2","rounded-full","bg-red-600","text-white","hover:bg-red-700",3,"click"],["d","M3 6h18v2H3V6zm2 3h14l-1.5 12h-11L5 9zm5 2v8h2v-8h-2zm4 0v8h2v-8h-2z"]],template:function(o,r){o&1&&(d(0,"div",0)(1,"div",1),I(2,"img",2),p(),d(3,"div",3)(4,"div")(5,"h3",4),u(6),p(),d(7,"p",5)(8,"strong"),u(9,"Language:"),p(),u(10),p()(),d(11,"div",6)(12,"div",7),D(13,Co,2,3,"button",8),D(14,_o,3,0,"button",9),p(),D(15,So,3,0,"button",10),p()()()),o&2&&(m(2),b("alt",ft(r.book().title))("src",r.book().imageLinks.thumbnail||r.book().imageLinks.smallThumbnail,Ee),m(4),$(r.book().title),m(4),M(" ",r.book().language),m(3),L(r.showDetailsBtn()?13:-1),m(),L(r.showFavourite()?14:-1),m(),L(r.showDelete()?15:-1))},dependencies:[je],encapsulation:2});let t=e;return t})();var Ht=(()=>{let e=class e{constructor(){this.location=c(Pe),this.router=c(H)}goBack(){window.history.length>1?this.location.back():this.router.navigate(["/books"])}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-back-button"]],decls:4,vars:0,consts:[[1,"pt-4","pl-4"],["appBackBtnClass","",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"]],template:function(o,r){o&1&&(d(0,"div",0)(1,"button",1),x("click",function(){return r.goBack()}),A(),d(2,"svg",2),I(3,"path",3),p()()())},dependencies:[jt],encapsulation:2});let t=e;return t})();function Yt(t,e){let n=N(t()),i;return le(o=>{let r=t();clearTimeout(i),i=setTimeout(()=>n.set(r),e),o(()=>clearTimeout(i))}),n}function To(t,e){if(t&1){let n=B();d(0,"button",6),x("click",function(){S(n);let o=k();return T(o.clear())}),A(),d(1,"svg",2),I(2,"path",7),p()()}}var Ii=(()=>{let e=class e{constructor(){this.searchControl=new Ne(""),this.searchValue=J(),this.query=N(""),this.debouncedQuery=Yt(this.query,400),this.searchControl.valueChanges.pipe(Ue()).subscribe(i=>{this.query.set(i?.trim()||"")}),le(()=>{this.searchValue.emit(this.debouncedQuery())})}clear(){this.searchControl.setValue("")}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-debounce-search"]],outputs:{searchValue:"searchValue"},decls:6,vars:2,consts:[[1,"relative","w-full","max-w-lg"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none","text-gray-400"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-4.35-4.35m0 0A7.5 7.5 0 1110.5 3a7.5 7.5 0 016.15 13.65z"],["type","text","placeholder","Search books...","aria-label","Search books",1,"w-full","pl-10","pr-10","py-2","rounded-xl","border","border-gray-300","shadow-sm","text-sm","text-gray-700","placeholder-gray-500","placeholder:italic","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition","duration-200",3,"formControl"],["type","button","aria-label","Clear search",1,"absolute","inset-y-0","right-0","pr-3","flex","items-center","text-gray-400","hover:text-gray-600","hover:scale-110","transition-transform","duration-150"],["type","button","aria-label","Clear search",1,"absolute","inset-y-0","right-0","pr-3","flex","items-center","text-gray-400","hover:text-gray-600","hover:scale-110","transition-transform","duration-150",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"]],template:function(o,r){o&1&&(d(0,"div",0)(1,"span",1),A(),d(2,"svg",2),I(3,"path",3),p()(),Ie(),I(4,"input",4),D(5,To,3,0,"button",5),p()),o&2&&(m(4),b("formControl",r.searchControl),m(),L(r.searchControl.value?5:-1))},dependencies:[ee,Et,me,Oe],encapsulation:2});let t=e;return t})();var Io=()=>["/books"],Wt=(t,e)=>e.path;function Eo(t,e){if(t&1&&(d(0,"a",5),u(1),p()),t&2){let n=e.$implicit;b("routerLink",n.path),m(),M(" ",n.label," ")}}function Bo(t,e){if(t&1){let n=B();d(0,"div",12)(1,"a",17),x("click",function(){S(n);let o=k();return T(o.closeDropdown())}),u(2," Profile "),p(),d(3,"button",18),x("click",function(){S(n);let o=k();return T(o.onLogout())}),u(4," Logout "),p()()}}function Fo(t,e){if(t&1){let n=B();d(0,"a",24),x("click",function(){S(n);let o=k(2);return T(o.toggleMobileMenu())}),u(1),p()}if(t&2){let n=e.$implicit;b("routerLink",n.path),m(),M(" ",n.label," ")}}function Mo(t,e){if(t&1){let n=B();d(0,"div",16)(1,"nav",19),V(2,Fo,2,2,"a",20,Wt),d(4,"div",21)(5,"a",22),x("click",function(){S(n);let o=k();return T(o.toggleMobileMenu())}),u(6," Profile "),p(),d(7,"button",23),x("click",function(){S(n);let o=k();return T(o.onLogout())}),u(8," Logout "),p()()()()}if(t&2){let n=k();m(2),P(n.navLinks)}}var Pi=(()=>{let e=class e{constructor(){this.store=c(K),this.isOpen=N(!1),this.isMobileMenu=N(!1),this.tokenStorageService=c($t),this.router=c(H),this.userService=c(re),this.navLinks=[{path:"/books",label:"Books"},{path:"/favourites",label:"Favourites"},{path:"/catalogue",label:"Catalogue"}]}toggleDropdown(){this.isOpen.update(i=>!i)}closeDropdown(){this.isOpen.set(!1)}toggleMobileMenu(){this.isMobileMenu.update(i=>!i)}onLogout(){this.tokenStorageService.clear(),localStorage.removeItem(q.USER),this.store.dispatch(Ut()),this.router.navigate(["/login"])}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-header"]],decls:20,vars:7,consts:[[1,"bg-white","shadow-md"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","items-center","h-16"],[1,"text-2xl","font-bold","text-blue-600","hover:text-blue-800","transition-colors",3,"routerLink"],[1,"hidden","md:flex","space-x-6"],["routerLinkActive","text-blue-600 font-semibold",1,"text-gray-700","hover:text-blue-600","transition-colors",3,"routerLink"],[1,"relative","hidden","md:block"],[1,"flex","items-center","space-x-2","focus:outline-none",3,"click"],["src","https://dummyjson.com/icon/emilys/128","alt","User Avatar",1,"w-10","h-10","rounded-full","border-2","border-blue-500"],[1,"hidden","md:inline","text-gray-700","font-medium"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-500","transition-transform","duration-200"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["role","menu",1,"absolute","right-0","mt-2","w-48","bg-white","rounded-lg","shadow-lg","py-2","z-50","animate-fadeIn"],[1,"md:hidden","text-gray-700","focus:outline-none",3,"click"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24","stroke-linecap","round","stroke-linejoin","round",1,"w-6","h-6"],["d","M4 6h16M4 12h16M4 18h16"],[1,"md:hidden","bg-white","border-t","animate-slideDown"],["routerLink","/profile",1,"block","px-4","py-2","text-gray-700","hover:bg-gray-50","transition-colors",3,"click"],[1,"w-full","text-left","px-4","py-2","text-gray-700","hover:bg-gray-50","transition-colors",3,"click"],[1,"px-2","pt-2","pb-3","space-y-1"],["routerLinkActive","bg-blue-100 text-blue-700",1,"block","px-3","py-2","rounded-md","text-gray-700","hover:bg-gray-50","hover:text-blue-600","transition-colors",3,"routerLink"],[1,"border-t","mt-2","pt-2"],["routerLink","/profile",1,"block","px-3","py-2","text-gray-700","hover:bg-gray-50","transition-colors",3,"click"],[1,"w-full","text-left","px-3","py-2","text-gray-700","hover:bg-gray-50","transition-colors",3,"click"],["routerLinkActive","bg-blue-100 text-blue-700",1,"block","px-3","py-2","rounded-md","text-gray-700","hover:bg-gray-50","hover:text-blue-600","transition-colors",3,"click","routerLink"]],template:function(o,r){if(o&1){let a=B();d(0,"header",0)(1,"div",1)(2,"div",2)(3,"a",3),u(4," BookApp "),p(),d(5,"nav",4),V(6,Eo,2,2,"a",5,Wt),p(),d(8,"div",6)(9,"button",7),x("click",function(){return S(a),T(r.toggleDropdown())}),I(10,"img",8),d(11,"span",9),u(12),p(),A(),d(13,"svg",10),I(14,"path",11),p()(),D(15,Bo,5,0,"div",12),p(),Ie(),d(16,"button",13),x("click",function(){return S(a),T(r.toggleMobileMenu())}),A(),d(17,"svg",14),I(18,"path",15),p()()()(),D(19,Mo,9,0,"div",16),p()}if(o&2){m(3),b("routerLink",Le(6,Io)),m(3),P(r.navLinks);let a=r.userService.getCurrentUserFromStorage();m(6),$(a==null?null:a.emailId),m(),De("rotate-180",r.isOpen()),m(2),L(r.isOpen()?15:-1),m(4),L(r.isMobileMenu()?19:-1)}},dependencies:[Ae,je,Tt],encapsulation:2});let t=e;return t})();function Ro(t,e){if(t&1){let n=B();d(0,"div",0)(1,"div",1)(2,"span"),u(3),p(),d(4,"button",2),x("click",function(){S(n);let o=k();return T(o.onClose())}),u(5," \u2716 "),p()()()}if(t&2){let n,i=k();m(3),$((n=i.message())==null?null:n.text)}}var Ki=(()=>{let e=class e{constructor(){this.messageService=c(z),this.message=this.messageService.message}onClose(){this.messageService.clear()}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-messages"]],decls:1,vars:1,consts:[["appMessageClass","",1,"fixed","z-50","flex","flex-col","gap-2"],[1,"flex","items-center","justify-between","px-4","py-2","rounded-lg","shadow-lg","max-w-xs","w-full","text-white","text-sm","font-medium","animate-slide-in"],[1,"ml-2","text-white","font-bold","hover:opacity-80","transition",3,"click"]],template:function(o,r){o&1&&D(0,Ro,6,1,"div",0),o&2&&L(r.message()?0:-1)},dependencies:[U,At],styles:["@keyframes _ngcontent-%COMP%_slide-in{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}@keyframes _ngcontent-%COMP%_slide-out{0%{transform:translate(0);opacity:1}to{transform:translate(100%);opacity:0}}.animate-slide-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slide-in .3s ease-out forwards}.animate-slide-out[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slide-out .3s ease-in forwards}"]});let t=e;return t})();var Ke=(()=>{var e;let n=class n{constructor(){v(this,e);y(this,e,c(K)),this.currentPage=Q(s(this,e).select(eo),{initialValue:1}),this.maxResults=Q(s(this,e).select(Zt),{initialValue:10}),this.totalItems=Q(s(this,e).select(Xt),{initialValue:0}),this.windowSize=Q(s(this,e).select(to),{initialValue:5}),this.maxPage=ie(()=>{let o=this.maxResults(),r=this.totalItems();return Math.ceil(r/o)})}nextPage(){this.currentPage()<this.maxPage()&&s(this,e).dispatch(ne({page:this.currentPage()+1}))}prevPage(){this.currentPage()>1&&s(this,e).dispatch(ne({page:this.currentPage()-1}))}goToPage(o){o>=1&&o<=this.maxPage()&&s(this,e).dispatch(ne({page:o}))}visiblePages(){let o=this.maxPage(),r=this.currentPage(),a=Math.floor((r-1)/this.windowSize())*this.windowSize()+1,l=Math.min(a+this.windowSize()-1,o);return Array.from({length:l-a+1},(f,C)=>a+C)}setCurrentPage(o=1){s(this,e).dispatch(ne({page:o}))}};e=new WeakMap,n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();function Do(t,e){if(t&1){let n=B();Me(0),d(1,"button",3),x("click",function(){let o=S(n).$implicit,r=k();return T(r.goToPage(o))}),u(2),p(),Re()}if(t&2){let n=e.$implicit,i=k();m(),De("bg-blue-500",n===i.currentPage)("text-white",n===i.currentPage)("bg-gray-200",n!==i.currentPage),m(),M(" ",n," ")}}var or=(()=>{var e;let n=class n{constructor(){v(this,e,c(Ke))}nextPage(){s(this,e).nextPage()}prevPage(){s(this,e).prevPage()}goToPage(o){s(this,e).goToPage(o)}get currentPage(){return s(this,e).currentPage()}get maxPage(){return s(this,e).maxPage()}get visiblePages(){return s(this,e).visiblePages()}};e=new WeakMap,n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=h({type:n,selectors:[["app-paging"]],decls:6,vars:3,consts:[[1,"flex","items-center","justify-center","gap-2","mt-4"],[1,"px-3","py-1","rounded","bg-gray-200","disabled:opacity-50",3,"click","disabled"],[4,"ngFor","ngForOf"],[1,"px-3","py-1","rounded",3,"click"]],template:function(r,a){r&1&&(d(0,"div",0)(1,"button",1),x("click",function(){return a.prevPage()}),u(2," Prev "),p(),Be(3,Do,3,7,"ng-container",2),d(4,"button",1),x("click",function(){return a.nextPage()}),u(5," Next "),p()()),r&2&&(m(),b("disabled",a.currentPage<=1),m(2),b("ngForOf",a.visiblePages),m(),b("disabled",a.currentPage>=a.maxPage))},dependencies:[U,kt],encapsulation:2});let t=n;return t})();var Lo=(t,e)=>e.value;function Vo(t,e){if(t&1&&(g(0,"option",4),u(1),w()),t&2){let n=e.$implicit;ge("value",n.value),m(),M(" ",n.label," ")}}var io=(()=>{let e=class e{constructor(){this.options=F([]),this.label=F(""),this.value=N(null),this.disabled=!1,this.onChange=i=>{},this.onTouched=()=>{}}writeValue(i){this.value.set(i)}registerOnChange(i){this.onChange=i}registerOnTouched(i){this.onTouched=i}setDisabledState(i){this.disabled=i}selectOption(i){let r=i.target.value;this.value.set(r),this.onChange(this.value()),this.onTouched()}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-select"]],inputs:{options:[1,"options"],label:[1,"label"]},features:[gt([{provide:It,useExisting:st(()=>e),multi:!0}])],decls:10,vars:4,consts:[[1,"flex-1","sm:flex-none","w-full","sm:w-50"],["for","select",1,"block","text-sm","font-medium","text-slate-700","mb-1"],[1,"relative"],["id","select",1,"w-full","h-10","appearance-none","px-3","pr-8","py-2","text-sm","border","border-slate-300","rounded-lg","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-green-500","hover:border-slate-400","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"change","value","disabled"],[3,"value"],[1,"pointer-events-none","absolute","inset-y-0","right-0","flex","items-center","pr-3"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4","text-slate-400","transition-transform","duration-200","group-focus:-rotate-180"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"]],template:function(o,r){o&1&&(g(0,"div",0)(1,"label",1),u(2),w(),g(3,"div",2)(4,"select",3),he("change",function(l){return r.selectOption(l)}),V(5,Vo,2,2,"option",4,Lo),w(),g(7,"div",5),A(),g(8,"svg",6),Fe(9,"path",7),w()()()()),o&2&&(m(2),M(" ",r.label()," "),m(2),ge("value",r.value())("disabled",r.disabled),ut("aria-label",r.label()),m(),P(r.options()))},encapsulation:2});let t=e;return t})();var yr=(()=>{let e=class e{constructor(){this.categories=[{label:"Choose Book Category",value:null},...Object.values(ro).map(i=>({label:i,value:i}))],this.category=new Ne(null),this.categorySelected=J(),this.category.valueChanges.pipe(Ue()).subscribe(i=>{this.categorySelected.emit(i)})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-book-category-dropdown"]],outputs:{categorySelected:"categorySelected"},decls:1,vars:2,consts:[[3,"formControl","options"]],template:function(o,r){o&1&&I(0,"app-select",0),o&2&&b("formControl",r.category)("options",r.categories)},dependencies:[ce,me,ee,Oe,io],encapsulation:2});let t=e;return t})();function Po(t,e){if(t&1&&(g(0,"span",2),u(1),w()),t&2){let n=e.$implicit;m(),M(" ",n," ")}}function jo(t,e){if(t&1&&(g(0,"span",5),u(1),w()),t&2){let n=e.$implicit;m(),M(" ",n," ")}}var no=(()=>{let e=class e{constructor(){this.book=F.required(),this.authorList=ie(()=>this.book().volumeInfo.authors??[]),this.categoryList=ie(()=>this.book().volumeInfo.categories??[])}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-book-content"]],inputs:{book:[1,"book"]},decls:10,vars:2,consts:[[1,"text-3xl","font-extrabold","text-slate-900"],[1,"mt-6","flex","flex-wrap","gap-2"],[1,"px-3","py-1","text-sm","font-medium","bg-blue-100","text-blue-800","rounded-full"],[1,"mt-4","text-slate-700","leading-relaxed","text-sm","md:text-base"],[1,"mt-5","flex","flex-wrap","gap-2"],[1,"px-2.5","py-1","text-xs","font-semibold","bg-green-100","text-green-700","rounded-full"]],template:function(o,r){o&1&&(g(0,"h1",0),u(1),w(),g(2,"div",1),V(3,Po,2,1,"span",2,ve),w(),g(5,"p",3),u(6),w(),g(7,"div",4),V(8,jo,2,1,"span",5,ve),w()),o&2&&(m(),M(" ",r.book().volumeInfo.title,`
`),m(2),P(r.authorList()),m(3),M(" ",r.book().volumeInfo.description,`
`),m(2),P(r.categoryList()))},encapsulation:2});let t=e;return t})();var ao=(()=>{let e=class e{constructor(){this.book=F.required(),this.thumbnail=ie(()=>this.book().volumeInfo.imageLinks?.thumbnail||this.book().volumeInfo.imageLinks?.smallThumbnail||"assets/default-thumbnail.png")}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-book-info"]],hostAttrs:[1,"md:w-1/3","bg-slate-50","p-6","flex","flex-col","items-center","md:items-start"],inputs:{book:[1,"book"]},decls:23,vars:6,consts:[[1,"w-full"],["loading","lazy",1,"w-full","h-auto","object-cover","rounded-lg","shadow-md",3,"src","alt"],[1,"sr-only"],[1,"mt-6","w-full"],[1,"text-lg","font-semibold","text-slate-900","mb-3"],[1,"space-y-2","text-sm","text-slate-700"],[1,"flex","justify-between"],[1,"font-medium","text-slate-900"],[1,"uppercase"]],template:function(o,r){o&1&&(g(0,"figure",0),Fe(1,"img",1),g(2,"figcaption",2),u(3),w()(),g(4,"section",3)(5,"h2",4),u(6,"Book details"),w(),g(7,"ul",5)(8,"li",6)(9,"span",7),u(10,"Publisher:"),w(),g(11,"span"),u(12),w()(),g(13,"li",6)(14,"span",7),u(15,"Pages:"),w(),g(16,"span"),u(17),w()(),g(18,"li",6)(19,"span",7),u(20,"Language:"),w(),g(21,"span",8),u(22),w()()()()),o&2&&(m(),ge("src",r.thumbnail(),Ee)("alt",r.book().volumeInfo.title),m(2),M(" ",r.book().volumeInfo.title," "),m(9),$(r.book().volumeInfo.publisher),m(5),$(r.book().volumeInfo.pageCount),m(5),$(r.book().volumeInfo.language))},encapsulation:2});let t=e;return t})();var so=(()=>{var e;let n=class n{constructor(){v(this,e);y(this,e,c(z)),this.favouriteBooks=N([])}loadFavouriteBooks(o){let r=localStorage.getItem(this.getKey(o)),a=r?JSON.parse(r):[];this.favouriteBooks.set(a)}addBookToFavourite(o,r){this.favouriteBooks().some(l=>l.id===o.id)||(this.favouriteBooks.update(l=>[o,...l]),this.saveToStorage(r))}removeBookFromFavourite(o,r){this.favouriteBooks.update(a=>a.filter(l=>l.id!==o.id)),this.saveToStorage(r),this.favouriteBooks().length===0&&localStorage.removeItem(this.getKey(r)),s(this,e).showMessage({text:`\u{1F4DA} "${o.title}" \u10EC\u10D0\u10E0\u10DB\u10D0\u10E2\u10D4\u10D1\u10D8\u10D7 \u10EC\u10D0\u10D8\u10E8\u10D0\u10DA\u10D0 \u10E1\u10D8\u10D8\u10D3\u10D0\u10DC!`,severity:G.Success})}getKey(o){return`${q.FAVOURITE}_${o}`}saveToStorage(o){localStorage.setItem(this.getKey(o),JSON.stringify(this.favouriteBooks()))}};e=new WeakMap,n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();var Ge=(()=>{let e=class e{constructor(){this.bookFacade=c(so)}get favouriteBooks(){return this.bookFacade.favouriteBooks}loadFavouriteBooks(i){this.bookFacade.loadFavouriteBooks(i)}addBookToFavourite(i,o){this.bookFacade.addBookToFavourite(i,o)}removeBookFromFavourite(i,o){this.bookFacade.removeBookFromFavourite(i,o)}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=E({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ao=(t,e)=>e.id;function No(t,e){if(t&1){let n=B();d(0,"app-book-card",2),x("addInFavourite",function(o){S(n);let r=k(2);return T(r.onAddInFavouriteEvent(o))}),p()}if(t&2){let n=e.$implicit;b("book",n)("showFavourite",!0)("showDetailsBtn",!0)}}function Oo(t,e){if(t&1&&(d(0,"div",0),V(1,No,1,3,"app-book-card",1,Ao),p()),t&2){let n=k();m(),P(n.books())}}var Hr=(()=>{var e,n,i;let o=class o{constructor(){v(this,e);v(this,n);v(this,i);y(this,e,c(ue)),y(this,n,c(Ge)),this.searchQuery=F(""),this.categorySelected=F(null),this.books=s(this,e).books,y(this,i,c(K)),this.userId=Q(s(this,i).select(de).pipe(se(a=>a!==null),O(1))),le(()=>{let a=this.searchQuery(),l=this.categorySelected(),f=this.userId();!a&&!l||!f||s(this,e).getBooks(a??null,l??null)})}onAddInFavouriteEvent(a){let l=this.userId();l&&s(this,n).addBookToFavourite(a,l)}};e=new WeakMap,n=new WeakMap,i=new WeakMap,o.\u0275fac=function(l){return new(l||o)},o.\u0275cmp=h({type:o,selectors:[["app-book-list"]],inputs:{searchQuery:[1,"searchQuery"],categorySelected:[1,"categorySelected"]},decls:1,vars:1,consts:[[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6"],[3,"book","showFavourite","showDetailsBtn"],[3,"addInFavourite","book","showFavourite","showDetailsBtn"]],template:function(l,f){l&1&&D(0,Oo,3,0,"div",0),l&2&&L(f.books()?0:-1)},dependencies:[ee,Qt],encapsulation:2});let t=o;return t})();function mo(t){return t.nonNullable.group({comment:t.nonNullable.control("",[et.maxLength(500),et.required]),star:t.nonNullable.control(0)})}var $o=()=>[1,2,3,4,5],Uo=(t,e)=>({"bg-blue-600 hover:bg-blue-700 text-white":t,"bg-gray-200 text-gray-500 cursor-not-allowed opacity-70":e}),Ko=(t,e)=>({"text-yellow-500":t,"text-gray-300":e});function Go(t,e){if(t&1){let n=B();Me(0),d(1,"span",7),x("click",function(){let o=S(n).$implicit,r=k();return T(r.setRating(o))})("mouseenter",function(){let o=S(n).$implicit,r=k();return T(r.hoveredStar=o)})("mouseleave",function(){S(n);let o=k();return T(o.hoveredStar=0)}),u(2," \u2605 "),p(),Re()}if(t&2){let n=e.$implicit,i=k();m(),dt("aria-label",vt("",n," star")),b("ngClass",Xe(3,Ko,n<=(i.hoveredStar||i.form.controls.star.value),n>(i.hoveredStar||i.form.controls.star.value)))}}var co=(()=>{var e;let n=class n{constructor(){v(this,e);this.fb=c(Rt),y(this,e,c(ze)),this.bookId=F.required(),this.reviewAdded=J(),this.hoveredStar=0,this.currentTab=R.reviews,this.form=mo(this.fb),this.userFromStorage=null;let o=localStorage.getItem(q.USER);this.userFromStorage=o?JSON.parse(o):null}get starCtrl(){return this.form.controls.star}get Readly(){return tt}onSubmit(o){if(this.form.invalid||!this.userFromStorage?.emailId)return;let{comment:r,star:a}=this.form.getRawValue();s(this,e).addReviewFromForm({comment:r,star:a},this.bookId(),this.userFromStorage.emailId).pipe(O(1),nt(()=>{this.reviewAdded.emit(),this.formDir.resetForm(this.form.value)})).subscribe()}onReset(o){o.preventDefault(),this.formDir.reset(this.form.value)}setRating(o){this.form.controls.star.setValue(o)}};e=new WeakMap,n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=h({type:n,selectors:[["app-add-review"]],viewQuery:function(r,a){if(r&1&&be($e,5),r&2){let l;xe(l=ke())&&(a.formDir=l.first)}},inputs:{bookId:[1,"bookId"]},outputs:{reviewAdded:"reviewAdded"},decls:12,vars:6,consts:[[1,"max-w-xl","mx-auto","p-6","bg-white","shadow-lg","rounded-2xl","space-y-6","border","border-slate-200",3,"ngSubmit","reset","formGroup"],["label","Comment","formControlName","comment"],[1,"flex","items-center","gap-2"],["for","rating",1,"block","text-sm","font-medium","text-slate-700","mb-1","mr-2"],[1,"flex","justify-end","gap-3","pt-4","border-t","border-slate-200"],["type","reset",1,"px-4","py-2","text-sm","font-medium","rounded-lg","border","border-slate-300","text-slate-700","hover:bg-slate-100","transition"],["type","submit",1,"px-4","py-2","text-sm","font-medium","rounded-lg","transition","shadow",3,"ngClass"],["id","rating",1,"cursor-pointer","text-2xl","transition-colors","duration-200",3,"click","mouseenter","mouseleave","aria-label","ngClass"]],template:function(r,a){r&1&&(d(0,"form",0),x("ngSubmit",function(f){return a.onSubmit(f)})("reset",function(f){return a.onReset(f)}),I(1,"app-textarea",1),d(2,"div",2)(3,"label",3),u(4,"Rating:"),p(),V(5,Go,3,6,"ng-container",null,ve),p(),d(7,"div",4)(8,"button",5),u(9," Reset "),p(),d(10,"button",6),u(11," Submit "),p()()()),r&2&&(b("formGroup",a.form),m(5),P(Le(2,$o)),m(5),b("ngClass",Xe(3,Uo,a.form.valid,a.form.invalid)))},dependencies:[U,xt,ce,Ft,me,Bt,ee,$e,Mt,Vt,Pt],encapsulation:2});let t=n;return t})();var zo=(t,e)=>e.userId;function qo(t,e){if(t&1&&(g(0,"article",1)(1,"figure",3)(2,"span",4),u(3,"person"),w()(),g(4,"section")(5,"header")(6,"h3",5),u(7),w()(),g(8,"p",6),u(9),w(),g(10,"p",7),u(11),w()()()),t&2){let n=e.$implicit;m(7),$(n.userFullname),m(2),pt(" ","\u2605".repeat(n.rating),"","\u2606".repeat(5-n.rating)," "),m(2),M(" ",n.comment," ")}}function Qo(t,e){t&1&&(g(0,"p",2),u(1," No Reviews "),w())}function Ho(t,e){if(t&1&&(g(0,"div",0),V(1,qo,12,4,"article",1,zo,!1,Qo,2,0,"p",2),w()),t&2){let n=k();m(),P(n.reviews())}}var uo=(()=>{let e=class e{constructor(){this.reviews=F.required()}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-review-list"]],inputs:{reviews:[1,"reviews"]},decls:3,vars:1,consts:[[1,"space-y-6"],[1,"flex","gap-4","p-4","bg-slate-50","rounded-lg","shadow-sm","hover:shadow","transition"],[1,"text-center","text-gray-500","text-lg","italic","py-10"],[1,"w-10","h-10","rounded-full","bg-slate-200","flex","items-center","justify-center"],["aria-hidden","true",1,"material-icons","text-slate-500"],[1,"font-semibold","text-slate-900"],["aria-label","User rating",1,"text-yellow-500","text-sm"],[1,"text-slate-700","text-sm","mt-1"]],template:function(o,r){o&1&&(lt(0,Ho,4,1),mt(1,0)),o&2&&(m(),ct(r.reviews()))},encapsulation:2});let t=e;return t})();var po=(()=>{let e=class e{constructor(){this.currentTab=R.reviews,this.tabChange=new fe,this.TabKey=R}selectTab(i){this.tabChange.emit(i)}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=h({type:e,selectors:[["app-tabs"]],inputs:{currentTab:"currentTab"},outputs:{tabChange:"tabChange"},decls:5,vars:2,consts:[["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"py-2","px-4","font-medium",3,"click","appTabActive"]],template:function(o,r){o&1&&(d(0,"nav",0)(1,"button",1),x("click",function(){return r.selectTab(r.TabKey.reviews)}),u(2," Reviews"),p(),d(3,"button",1),x("click",function(){return r.selectTab(r.TabKey.addReview)}),u(4," Add Review "),p()()),o&2&&(m(),b("appTabActive",r.currentTab===r.TabKey.reviews),m(2),b("appTabActive",r.currentTab===r.TabKey.addReview))},dependencies:[U,Nt],encapsulation:2});let t=e;return t})();var Yo=["addReviewTemplate"],Jo=["reviewsTemplate"],Wo=t=>({$implicit:t});function Xo(t,e){if(t&1&&(Je(0,5),ht(1,"async")),t&2){let n=k(),i=We(6);b("ngTemplateOutlet",i)("ngTemplateOutletContext",Ve(4,Wo,bt(1,2,n.reviews$)))}}function Zo(t,e){if(t&1&&Je(0,6),t&2){k();let n=We(8);b("ngTemplateOutlet",n)}}function ei(t,e){if(t&1&&I(0,"app-review-list",7),t&2){let n=e.$implicit;b("reviews",n)}}function ti(t,e){if(t&1){let n=B();d(0,"app-add-review",8),x("reviewAdded",function(){S(n);let o=k();return T(o.onReviewAdded())}),p()}if(t&2){let n=k();b("bookId",n.bookId())}}var fo=(()=>{var e,n;let i=class i{constructor(){v(this,e);v(this,n);y(this,e,c(qe)),y(this,n,c(ze)),this.bookId=F.required(),this.TabKey=R,this.currentTab=R.reviews}ngOnInit(){this.reviews$=s(this,n).loadReviewsByBookid(this.bookId()),this.reviews$.pipe(O(1)).subscribe(r=>{this.currentTab=r.length>0?R.reviews:R.addReview})}get tabs(){return s(this,e).tabs(this.reviewsTemplate,this.addReviewTemplate)}selectTab(r){this.currentTab=r}onReviewAdded(){this.currentTab=R.reviews}};e=new WeakMap,n=new WeakMap,i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=h({type:i,selectors:[["app-reviews-tab"]],viewQuery:function(a,l){if(a&1&&(be(Yo,5),be(Jo,5)),a&2){let f;xe(f=ke())&&(l.addReviewTemplate=f.first),xe(f=ke())&&(l.reviewsTemplate=f.first)}},inputs:{bookId:[1,"bookId"]},decls:9,vars:2,consts:[["reviewsTemplate",""],["addReviewTemplate",""],[1,"border-b","border-slate-200","mb-6"],[3,"tabChange","currentTab"],[1,"tab-content","mt-6"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngTemplateOutlet"],[3,"reviews"],[3,"reviewAdded","bookId"]],template:function(a,l){if(a&1){let f=B();d(0,"div",2)(1,"app-tabs",3),x("tabChange",function(Y){return S(f),T(l.selectTab(Y))}),p()(),d(2,"div",4),D(3,Xo,2,6,"ng-container",5)(4,Zo,1,1,"ng-container",6),p(),Be(5,ei,1,1,"ng-template",null,0,Ze)(7,ti,1,1,"ng-template",null,1,Ze)}if(a&2){let f;m(),b("currentTab",l.currentTab),m(2),L((f=l.currentTab)===l.TabKey.reviews?3:f===l.TabKey.addReview?4:-1)}},dependencies:[co,U,wt,po,uo,yt],encapsulation:2});let t=i;return t})();var ta=(()=>{var e,n,i,o;let r=class r{constructor(){v(this,e);v(this,n);v(this,i);v(this,o);y(this,e,c(St)),y(this,n,c(qe)),y(this,i,c(re)),this.user=s(this,i).getCurrentUserFromStorage(),this.book=N(s(this,e).snapshot.data.book),this.userService=c(re),y(this,o,c(K)),this.userId=Q(s(this,o).select(de).pipe(se(l=>l!==null),O(1)))}goBack(){s(this,n).goBack()}addToFavouritesEvent(){let l=this.userId();l&&s(this,n).addToFavouritesEvent(this.book(),l)}addToCatalogueEvent(){let l=this.userId();l&&s(this,n).addToCatalogueEvent(this.book(),l)}};e=new WeakMap,n=new WeakMap,i=new WeakMap,o=new WeakMap,r.\u0275fac=function(f){return new(f||r)},r.\u0275cmp=h({type:r,selectors:[["app-book-details"]],decls:8,vars:3,consts:[[1,"max-w-6xl","mx-auto","my-10","bg-white","shadow-xl","rounded-2xl","border","border-slate-100","overflow-hidden"],[1,"flex","flex-col","md:flex-row"],[3,"book"],[1,"flex-1","p-8"],[3,"addToCatalogue","addToFavourites"],[3,"bookId"]],template:function(f,C){f&1&&(I(0,"app-back-button"),d(1,"div",0)(2,"div",1),I(3,"app-book-info",2),d(4,"div",3),I(5,"app-book-content",2),d(6,"app-book-actions",4),x("addToCatalogue",function(){return C.addToCatalogueEvent()})("addToFavourites",function(){return C.addToFavouritesEvent()}),p(),I(7,"app-reviews-tab",5),p()()()),f&2&&(m(3),b("book",C.book()),m(2),b("book",C.book()),m(2),b("bookId",C.book().id))},dependencies:[U,Ae,Ht,ce,ao,no,qt,fo],encapsulation:2});let t=r;return t})();var la=t=>ot(null,null,function*(){let e=t.paramMap.get("id"),n=c(ue),i=c(H);if(!e)return i.navigate(["/books"]),Promise.reject("No BookId");try{let o=yield it(n.bookById(e));return o||(i.navigate(["/books"]),Promise.reject("Book not found"))}catch(o){return i.navigate(["/books"]),Promise.reject(o)}});var vo=(()=>{let e=class e{constructor(){this.messages=c(z),this.errorMessage="Failed to save catalogue to localStorage",this.books=new _e([]),this.books$=this.books.asObservable()}loadCatalogueBooks(i){let o=localStorage.getItem(this.getKey(i)),r=o?JSON.parse(o):[];this.books.next(r)}addBook(i,o){let r=this.mapToBookView(i,o),a=this.books.value;a.some(f=>f.id===r.id&&f.userId===o)||this.updateBooks([r,...a],o)}mapToBookView(i,o){return{id:i.id,title:i.volumeInfo.title,authors:i.volumeInfo.authors??[],language:i.volumeInfo.language,imageLinks:{thumbnail:i.volumeInfo.imageLinks.thumbnail||"assets/no-image.png",smallThumbnail:i.volumeInfo.imageLinks.smallThumbnail||"assets/no-image.png"},categories:i.volumeInfo.categories,userId:o}}removeBook(i,o){let r=this.books.value.filter(a=>a.id!==i.id);this.updateBooks(r,o)}updateBooks(i,o){this.books.next(i);try{if(i.length===0){localStorage.removeItem(this.getKey(o));return}localStorage.setItem(this.getKey(o),JSON.stringify(this.books.value))}catch(r){this.messages.showMessage({text:`\u{1F4DA} ${this.errorMessage}- ${r}`,severity:G.Error,duration:5e3})}}getKey(i){return`${q.CATALOGUE}_${i}`}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=E({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var go=(()=>{var e;let n=class n{constructor(){v(this,e);y(this,e,c(vo)),this.books$=s(this,e).books$}addBook(o,r){s(this,e).addBook(o,r)}loadCatalogueBooks(o){s(this,e).loadCatalogueBooks(o)}removeBook(o,r){s(this,e).removeBook(o,r)}};e=new WeakMap,n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();var ho=(()=>{var e,n,i,o,r;let a=class a{constructor(){v(this,e,c(Pe));v(this,n,c(H));v(this,i,c(Ge));v(this,o,c(z));v(this,r,c(go))}tabs(f,C){return!f||!C?[]:[{key:R.reviews,label:R.reviews,template:f},{key:R.addReview,label:R.addReview,template:C}]}goBack(){(window.history.length>1?()=>s(this,e).back():()=>s(this,n).navigate(["/books"]))()}addToFavouritesEvent(f,C){let Y={id:f.id,title:f.volumeInfo.title,authors:f.volumeInfo.authors,language:f.volumeInfo.language,imageLinks:{thumbnail:f.volumeInfo.imageLinks.thumbnail,smallThumbnail:f.volumeInfo.imageLinks.smallThumbnail},categories:f.volumeInfo.categories,userId:C};s(this,i).addBookToFavourite(Y,C),s(this,n).navigateByUrl("/favourites"),s(this,o).showMessage({text:`\u{1F4DA} "${f.volumeInfo.title}" \u10EC\u10D0\u10E0\u10DB\u10D0\u10E2\u10D4\u10D1\u10D8\u10D7 \u10D3\u10D0\u10D4\u10DB\u10D0\u10E2\u10D0 \u10D7\u10E5\u10D5\u10D4\u10DC\u10E1 \u10E4\u10D0\u10D5\u10DD\u10E0\u10D8\u10E2\u10D4\u10D1\u10E8\u10D8!`,severity:G.Success})}addToCatalogueEvent(f,C){s(this,r).addBook(f,C),s(this,n).navigateByUrl("/catalogue"),s(this,o).showMessage({text:`\u{1F4DA} "${f.volumeInfo.title}" \u10EC\u10D0\u10E0\u10DB\u10D0\u10E2\u10D4\u10D1\u10D8\u10D7 \u10D3\u10D0\u10D4\u10DB\u10D0\u10E2\u10D0 \u10D7\u10E5\u10D5\u10D4\u10DC\u10E1 \u10D9\u10D0\u10E2\u10D0\u10DA\u10DD\u10D2\u10E8\u10D8!`,severity:G.Success})}};e=new WeakMap,n=new WeakMap,i=new WeakMap,o=new WeakMap,r=new WeakMap,a.\u0275fac=function(C){return new(C||a)},a.\u0275prov=E({token:a,factory:a.\u0275fac,providedIn:"root"});let t=a;return t})();var qe=(()=>{var e;let n=class n{constructor(){v(this,e,c(ho))}goBack(){s(this,e).goBack()}tabs(o,r){return s(this,e).tabs(o,r)}addToFavouritesEvent(o,r){s(this,e).addToFavouritesEvent(o,r)}addToCatalogueEvent(o,r){s(this,e).addToCatalogueEvent(o,r)}};e=new WeakMap,n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();var te=Dt("books"),bo=W(te,t=>t.items),Xt=W(te,t=>t.totalItems),Aa=W(te,t=>t.loading),Na=W(te,t=>t.error),Zt=W(te,t=>t.maxResults),eo=W(te,t=>t.currentPage),to=W(te,t=>t.windowSize),Oa=W(te,t=>t.startIndex);var xo=(()=>{var e,n;let i=class i{constructor(){v(this,e);v(this,n);this.http=c(_t),y(this,e,c(K)),y(this,n,c(Ke)),this.books=Q(s(this,e).select(bo),{initialValue:[]})}getStartIndex(){return s(this,n).currentPage()-1}searchBooksByName(r,a,l,f){return this.http.get(`/volumes?q=${r}&maxResults=${a}&startIndex=${l}`).pipe(Z(C=>({items:(C.items||[]).map(j=>({id:j.id,title:j.volumeInfo.title,authors:j.volumeInfo.authors||[],imageLinks:j.volumeInfo.imageLinks||{thumbnail:"",smallThumbnail:""},language:j.volumeInfo.language||"",categories:j.volumeInfo.categories,userId:f})),totalItems:C.totalItems||0})),Ye(1))}loadBooksByCategory(r,a,l,f){return this.http.get(`/volumes?q=${r}&maxResults=${a}&startIndex=${l}`).pipe(Z(C=>({items:(C.items||[]).map(j=>({id:j.id,title:j.volumeInfo.title,authors:j.volumeInfo.authors||[],imageLinks:j.volumeInfo.imageLinks||{thumbnail:"",smallThumbnail:""},language:j.volumeInfo.language||"",categories:j.volumeInfo.categories,userId:f})),totalItems:C.totalItems||0})),Ye(1))}bookById(r){return this.http.get(`/volumes/${r}`,{context:new Ct().set(Ot,!0)}).pipe(Z(a=>{let l=a.volumeInfo;return{id:a.id,saleInfo:X({},a.saleInfo),volumeInfo:oe(X({},a.volumeInfo),{publisher:l?.publisher||"",publishedDate:l?.publishedDate||"",description:l?.description||"",pageCount:l?.pageCount||0,printType:l?.printType||"",categories:l?.categories||[],previewLink:l?.previewLink||""})}}))}getBooks(r,a){r&&r.length>3?(a=null,s(this,e).dispatch(ae({query:r,maxResults:s(this,n).maxResults(),startIndex:this.getStartIndex()}))):a?(r=null,s(this,e).dispatch(ae({query:a,maxResults:s(this,n).maxResults(),startIndex:this.getStartIndex()}))):s(this,e).dispatch(pe({error:"No query or category selected"}))}resetPage(){s(this,n).setCurrentPage()}};e=new WeakMap,n=new WeakMap,i.\u0275fac=function(a){return new(a||i)},i.\u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"});let t=i;return t})();var ue=(()=>{let e=class e{constructor(){this.bookFacade=c(xo),this.books=this.bookFacade.books}searchBooksByName(i,o,r,a){return this.bookFacade.searchBooksByName(i,o,r,a)}loadBooksByCategory(i,o,r,a){return this.bookFacade.loadBooksByCategory(i,o,r,a)}bookById(i){return this.bookFacade.bookById(i)}getBooks(i,o){return this.bookFacade.getBooks(i,o)}resetPage(){return this.bookFacade.resetPage()}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=E({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ko=(()=>{let e=class e{loadReviews(){let i=sessionStorage.getItem(q.BOOK_REVIEWS);return i?JSON.parse(i):[]}saveReviewToStorage(i){sessionStorage.setItem(q.BOOK_REVIEWS,JSON.stringify(i))}canUserAddReview(i,o){return!(this.loadReviews()||[]).some(l=>l.bookId===i&&l.userId===o)}createReview(i,o,r){return{userId:r.userId,userFullname:r.fullName,comment:i.comment,rating:i.star,bookId:o}}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=E({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ze=(()=>{var e,n,i;let o=class o{constructor(){v(this,e);v(this,n);v(this,i);y(this,e,c(ko)),y(this,n,c(z)),y(this,i,c(re)),this.reviews=new _e([]),this.reviews$=this.reviews.asObservable(),this.refreshReviews()}refreshReviews(){this.reviews.next(s(this,e).loadReviews())}loadReviewsByBookid(a){return this.reviews$.pipe(Z(l=>l.filter(f=>f.bookId===a)))}saveAndNotify(a){this.reviews.next([a,...this.reviews.value]),s(this,e).saveReviewToStorage(this.reviews.value),s(this,n).showMessage({text:`${a.userId} \u10EC\u10D0\u10E0\u10DB\u10D0\u10E2\u10D4\u10D1\u10D8\u10D7 \u10D3\u10D0\u10D0\u10DB\u10D0\u10E2\u10D0 \u10D9\u10DD\u10DB\u10D4\u10DC\u10E2\u10D0\u10E0\u10D8!`,severity:G.Success})}addReviewFromForm(a,l,f){return s(this,i).getUserbyEmail(f).pipe(O(1),Te(C=>{if(!C)return He;if(!s(this,e).canUserAddReview(l,C.userId))return s(this,n).showMessage({text:"\u10E3\u10D9\u10D5\u10D4 \u10D3\u10D0\u10DB\u10D0\u10E2\u10D4\u10D1\u10E3\u10DA\u10D8\u10D0 \u10D9\u10DD\u10DB\u10D4\u10DC\u10E2\u10D0\u10E0\u10D8 \u10D0\u10DB \u10EC\u10D8\u10D2\u10DC\u10D6\u10D4!",severity:G.Info}),He;let Y=s(this,e).createReview(a,l,C);return this.saveAndNotify(Y),Se(!0)}))}};e=new WeakMap,n=new WeakMap,i=new WeakMap,o.\u0275fac=function(l){return new(l||o)},o.\u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"});let t=o;return t})();var ae=we("[Books] Load Books",ye()),Qe=we("[Books] Load Books Success",ye()),pe=we("[Books] Load Books Failure",ye()),ne=we("[Books] Set Current Page",ye());var _s=(()=>{var e,n;let i=class i{constructor(){v(this,e);v(this,n);this.actions$=c(Gt),y(this,e,c(K)),y(this,n,c(ue)),this.loadBooks$=Kt(()=>this.actions$.pipe(zt(ae),at(s(this,e).select(de).pipe(se(r=>r!==null),O(1))),Te(([r,a])=>(r.query.length>3?s(this,n).searchBooksByName(r.query,r.maxResults,r.startIndex,a):s(this,n).loadBooksByCategory(r.query,r.maxResults,r.startIndex,a)).pipe(Z(f=>Qe({books:f,maxResults:r.maxResults,startIndex:r.startIndex})),rt(f=>Se(pe({error:f.message})))))))}};e=new WeakMap,n=new WeakMap,i.\u0275fac=function(a){return new(a||i)},i.\u0275prov=E({token:i,factory:i.\u0275fac});let t=i;return t})();var oi={items:[],totalItems:0,loading:!1,error:null,currentPage:1,maxResults:10,windowSize:5,startIndex:0},Bs=Lt(oi,Ce(ae,t=>oe(X({},t),{loading:!0,error:null})),Ce(Qe,(t,{books:e,maxResults:n,startIndex:i})=>oe(X({},t),{items:e.items,totalItems:e.totalItems,maxResults:n,currentPage:i+1,startIndex:i,loading:!1,error:null})),Ce(pe,(t,{error:e})=>oe(X({},t),{items:[],totalItems:0,loading:!1,error:e})),Ce(ne,(t,{page:e})=>oe(X({},t),{currentPage:e})));var ro={Fiction:"Fiction",Science:"Science",Computers:"Computers",BusinessEconomics:"Business & Economics",Character:"Character"};var tt=(function(t){return t.Read="Read",t.Unread="Not Read Yet",t})(tt||{}),ii=(function(t){return t.Today="Today",t.In1Week="In 1 week",t.In2Weeks="In 2 Weeks",t.In1Month="In 1 month",t.ThisYear="This Year",t})(ii||{});export{qt as a,Qt as b,Ht as c,Ii as d,Pi as e,Ki as f,or as g,yr as h,no as i,ao as j,Ge as k,Hr as l,co as m,uo as n,fo as o,ta as p,la as q,go as r,ho as s,qe as t,te as u,bo as v,Xt as w,Aa as x,Na as y,Zt as z,eo as A,to as B,Oa as C,xo as D,ue as E,ko as F,ze as G,ae as H,Qe as I,pe as J,ne as K,_s as L,oi as M,Bs as N,ro as O,tt as P,ii as Q};
